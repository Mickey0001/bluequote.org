(function(){function a(e,d,c){e.splice(d,!c||1+c-d+(!(c<0^d>=0)&&(c<0||-1)*e.length));return e.length}var b=function(){var c=[],e=-1,d=0,g=false,h,f;f=function(j,i){if(!j||typeof j[i]!=="function"){return this}g=true;j[i]();g=false;return this};return{add:function(i){if(g){return this}c.splice(e+1,c.length-e);c.push(i);if(d&&c.length>d){a(c,0,-(d+1))}e=c.length-1;if(h){h()}return this},setCallback:function(i){h=i},undo:function(){var i=c[e];if(!i){return this}f(i,"undo");e-=1;if(h){h()}return this},redo:function(){var i=c[e+1];if(!i){return this}f(i,"redo");e+=1;if(h){h()}return this},clear:function(){var i=c.length;c=[];e=-1;if(h&&(i>0)){h()}},hasUndo:function(){return e!==-1},hasRedo:function(){return e<(c.length-1)},getCommands:function(){return c},getIndex:function(){return e},setLimit:function(i){d=i}}};if(typeof define==="function"&&typeof define.amd==="object"&&define.amd){define(function(){return b})}else{if(typeof module!=="undefined"&&module.exports){module.exports=b}else{window.UndoManager=b}}}());